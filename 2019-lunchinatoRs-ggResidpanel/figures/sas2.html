
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html">
<meta http-equiv="Content-Language" content="en-US">
<meta http-equiv="Reply-To" content="webmaster@stat.ncsu.edu">
<meta name="author" content="Statistics: Marie Davidian">
<meta name="revised" content="01/04/2015">
<meta name="description" content="ST 732">
<title> ST 732 - Spring 2019</title>
<style type="text/css" media="screen">@import url(css/default.css);</style>
<style type="text/css" media="print">@import url(css/print.css);</style>
<link rel="SHORTCUT ICON" href="images/favicon/ncsu-s.ico">
</head>

<body>
<div id="header">
	<div style="float: left">
	<a href="http://www.ncsu.edu" target="NCSU"><img src="ncsu_logo.gif" border="0" alt="North Carolina State University"></a>
	</div>

<div style="float:right">
	<a href="http://www.ncsu.edu" target="NCSU"><img src="ncsu_logo.gif" border="0" alt="North Carolina State University"></a>
	</div>

<center><h3><b><a name="top"></a> ST 732, Longitudinal Data Analysis, Spring 2019</b></h3> 
<font size=3><a href="http://www4.stat.ncsu.edu/~davidian/index.html"> Marie Davidian
</a>, 5124 <a href="http://www.ncsu.edu/facilities/buildings/sashall.html">SAS 
    Hall</a> <br />
T-Th, 3:00 pm - 4:15 pm, 5270
<a href="http://www.ncsu.edu/facilities/buildings/sashall.html">
SAS Hall</a><br /> 
Office hours Th, 1:00 pm -2:00 pm, and by appointment  </font><br /> 
</center>
</div>

<br class="clear_float" />

<ul id="nav">
<li><a href="http://transcoder.ncsu.edu:8080/tt/referrer">Text Only</a></li>
<li><a href="/">NCSU Statistics</a></li>
</ul>

<div class="col">
<font size=2>
<p><a href="index.html">Course info</a></p>
<p><a href="syllabus.pdf">Course syllabus</a></p>
<p><a href="notes.html">Class notes </a></p>
<p><a href="hwk.html">Homework assignments and solutions</a></p>
<p><a href="midterm.html">Midterm</a></p>
<p><a href="project.html">Project</a></p> 
<p><a href="examples.html">Examples</a></p> 
<p><a href="announce.html">Announcements</a></p>
&nbsp;<br />
</font>
</div>

<a name="Content"></a>
<div class="col2">
<p>

  <h2>SAS and R Examples</h2> <img src="fade.jpg" alt=""><br><p>

  We will
  discuss use of both R and SAS to implement the methods discussed in the
  course.  Below are links to R and SAS documentation and example
  programs discussed in class.
  <ul>

<li> <i> <font color="#cc0000">Information on R</font></i>.  <a
href="http://www.r-project.org/">The R Homepage</a> has links to 
  manuals and other information. <p>

       <li> <i> <font color="#cc0000">SAS documentation</font></i>.
      <a
href="http://support.sas.com/documentation/94/">SAS 9.4 Documentation Homepage</a>.<p>

<li><i><font color="#cc0000">R nlme
      package</font></i>. <a href="https://cran.r-project.org/web/packages/nlme/index.html">Documentation</a>;
      see also the
      book <a href="http://link.springer.com/book/10.1007%2Fb98882">Mixed-Effects
    Models in S and S-PLUS</a> by Pinheiro and Bates.<p>

 <li><i><font color="#cc0000">R lme4
 package</font></i>. <a href="https://cran.r-project.org/web/packages/lme4/index.html">Documentation
 and vignettes</a>.<p>

<li> <i> <font color="#cc0000">SAS glimmix macro</font></i>.  <a
href="examples/glmm800.sas">Macro and documentation</a>.<p>    

<li> <i> <font color="#cc0000">SAS nlinmix macro</font></i>.  <a
href="examples/nlmm801.sas">Macro and documentation</a>.<p>    

<li> <i> <font color="#cc0000">Handy guide to SAS resources for
    fitting generalized linear and nonlinear models for
    longitudinal/clustered data (thanks to Nathan Corder)</font></i>.  (<a
href="examples/Choosing_Modeling_Function_in_SAS.pdf">pdf</a>).<p>  

    
<li><i> <font color="#cc0000">Chapter 1, EXAMPLE 1, Dental Study.  Making spaghetti plots in 
      R</font></i>.  <a href="examples/dental_spaghetti.R">R program</a> and 
  <a href="examples/dental_spaghetti.pdf">plot made
    using the R function interaction.plot()</a>
  <a href="examples/dental_bygender.pdf">using the package ggplot2</a>, and
  <a href="examples/dental.dat">data set in "long" format</a>.  <p> 

    <li><i> <font color="#cc0000">Chapter 2, EXAMPLE 1, Dental Study.
Using R and SAS to obtain sample means, covariance and correlation matrices,
 scatterplot matrices, lag plots, and autocrrlation functions for balanced data</a>
 </font></i>.  <a href="examples/dental_corr.R">R program</a> and 
<a href="examples/girlsscatter.pdf">scatter plot matrix for girls</a> and
<a href="examples/boysscatter.pdf">for boys</a>; and
  <a href="examples/dental_corr.sas">SAS program</a> and
  <a href="examples/dental_corr.lst">output</a>.<p>

  <li><i> <font color="#cc0000">Chapter 3, EXAMPLE 1, Dental Study.  Using SAS to carry
	out univariate and multivariate repeated measures analysis of variance</font></i>.
    <a href="examples/dental_rmanova.sas">SAS program</a> and 
    <a href="examples/dental_rmanova.lst">output</a>.  <p>

  <li><i> <font color="#cc0000">Chapter 3, EXAMPLE 2, Guinea Pig Diet Study.  Using SAS to carry
	out univariate and multivariate repeated measures analysis of variance</font></i>.
    <a href="examples/diet_rmanova.sas">SAS program</a>,
    <a href="examples/diet_rmanova.lst">output</a>, and
    <a href="examples/diet.dat">data set in "wide" format</a>.   <p>

   <li><i> <font color="#cc0000">Chapter 5, HIV Clinical Trial.  Using
    R to make spaghetti plots with smooth overlay</font></i>.
    <a href="examples/cd4_plot.R">R program</a>,
    <a href="examples/cd4_bytrt.pdf">plot using ggplot2</a>, and
    <a href="examples/cd4.dat">data set in "long" format</a>.   <p>

<li><i> <font color="#cc0000">Chapter 5, EXAMPLE 1, Dental Study.
Using SAS proc mixed and R gls() to implement the linear population-averaged model</font></i>.
    <a href="examples/dental_pa.sas">SAS program</a> and 
<a href="examples/dental_pa.lst">output</a>; and
 <a href="examples/dental_pa.R">R program</a>.  <p>

<li><i>  <font color="#cc0000">Chapter 5, Hip
Replacement Study.  Using SAS proc mixed and R gls() to implement the
linear population-averaged model with care taken to take proper
account of missing observations</font></i>.
    <a href="examples/hips_pa.sas">SAS program</a> and 
<a href="examples/hips_pa.lst">output</a>;
 <a href="examples/hips_pa.R">R program</a>; and <a href="examples/hips.dat">data set in "long" format</a>. <p>

<li><i> <font color="#cc0000">Chapter 6, EXAMPLE 1, Dental Study.
Using SAS proc mixed and R lme() and lmer() to implement the linear mixed effects  model</font></i>.
    <a href="examples/dental_lme.sas">SAS program</a> and 
    <a href="examples/dental_lme.lst">output</a>,
    plus <a href="examples/dentalresid.sas.pdf">residual analysis</a>
    and plots of <a href="examples/PearsonPanel.png">PA Pearson residuals</a> and 
    <a href="examples/PearsonPanel1.png">SS (conditional) Pearson residuals</a> for final chosen model. 
     <a href="examples/dental_lme.R">R program using lme()</a>, 
     of <a href="examples/dental.residplot.pdf">plot of SS Pearson residuals</a> and 
     <a href="examples/dental.qqplot.pdf">QQ plot of Pearson residuals</a>, and
     <a href="examples/dental.qqplot.raneff.pdf">QQ plots</a> and  <a href="examples/dental.histo.raneff.pdf">histograms</a>
 of empirical Bayes estimates of random effects for final chosen model.
     <a href="examples/dental_lmer.R">R program using lmer()</a>.<p>

<li><i> <font color="#cc0000">Chapter 7, Indomethacin PK Study.
Fitting a nonlinear model with a variance function with unknown
parameter to univariate PK data from a single subject following dose of
indomethacin</font></i>.  <a href="examples/indo_gls.sas">A homegrown SAS macro
using proc nlin</a> and <a href="examples/indo_gls.lst">output</a>; <a
href="examples/indo_gnls.R">R program</a> using the gnls() function in
the nlme package; and <a href="examples/indo.dat">data set in "long"
format</a>.<p>

<li><i> <font color="#cc0000">Chapter 7, Risk Factors for Myocardial Infarction.
Fitting a logistic regression model to univariate binary response data using SAS
proc genmod and R function glm()</font></i>. 
<a href="examples/infarc_glim.sas">SAS program</a> and <a href="examples/infarc_glim.lst">output</a>; <a
href="examples/infarc_glim.R">R program</a>; and <a href="examples/infarc.dat">data set in "long"
format</a>.<p>

<li><i> <font color="#cc0000">Chapter 8, EXAMPLE 5, Epileptic Seizure
Clinical Trial.  Using SAS proc gemod, proc gee, and proc glimmix and
R gee() and geeglm() to implement a loglinear population-averaged
model for response in the form of a count</font></i>.  <a href="examples/seizure_gee.sas">SAS program</a>
and <a href="examples/seizure_gee.lst">output</a>; <a
href="examples/seizure_gee.R">R program</a>; and <a
href="examples/seize.dat">data set in "long" format</a>.  <p>

<li><i> <font color="#cc0000">Chapter 8, EXAMPLE 6, Six Cities
Respiratory Study.  Using SAS proc gemod, proc gee, and proc glimmix and
R gee() and geeglm() to implement a logistic population-averaged
model for binary response</font></i>.  <a href="examples/wheeze_gee.sas">SAS program</a>
and <a href="examples/wheeze_gee.lst">output</a>; <a
href="examples/wheeze_gee.R">R program</a>; and <a
href="examples/wheeze.dat">data set in "wide" format</a>.  <p>

<li><i> <font color="#cc0000">Chapter 9, EXAMPLE 5, Epileptic Seizure
Clinical Trial.  Using SAS proc glimmix, proc nlmixed, the glimmix
macro, and R glmer() in the lme4 package to implement loglinear subject-specific
models for response in the form of a count</font></i>.  <a
href="examples/seizure_procglimmix.sas">SAS program
using proc glimmix</a> and <a
href="examples/seizure_procglimmix.lst">output</a>;
<a href="examples/seizure_glimmix.sas">SAS program
using the glimmix macro</a>, <a
href="examples/seizure_glimmix.log">log file</a>, 
and <a
href="examples/seizure_glimmix.lst">output</a>;
<a href="examples/seizure_nlmixed.sas">SAS program using proc
nlmixed</a> and <a
href="examples/seizure_nlmixed.lst">output</a>;
<a href="examples/seizure_glmer.R">R program using glmer()</a>; and <a
href="examples/seize.dat">data set in "long" format</a>.<p>

<li><i> <font color="#cc0000">Chapter 9, Argatroban pharmacokinetic study.
Using SAS macro nlinmix, proc nlmixed, and R nlme() to implement
the nonlinear mixed effects model in the course notes.
</font></i>.  <a href="examples/arg_nlinmix.sas">SAS program
using the nlinmix macro</a>, <a
href="examples/arg_nlinmix.log">log file</a>, 
and <a
href="examples/arg_nlinmix.lst">output</a>;
<a href="examples/arg_nlmixed.sas">SAS program using proc
nlmixed</a>, <a href="examples/arg_nlmixed.log">log file</a>, 
and <a
href="examples/arg_nlmixed.lst">output</a>; 
<a href="examples/arg_nlme.R">R program using nlme()</a>; <a
href="examples/argconc.dat">data set in "long" format</a>;
and <a href="examples/arg_gts.R">R program using the "pooled" GLS
algorithm and the GTS EM algorithm</a> and <a
href="examples/arg_gts.Rout">output</a>; and 
<a href="examples/arg_mixsetup.R">R program using the "pooled" GLS
algorithm to get individual estimates and create "data" for a "linear
mixed effects model"</a> as in Section 9.4 of the notes, <a
href="examples/arg_mixmod.sas">SAS program to read in "data" and fit
"linear mixed effects model"</a>, and <a
href="examples/arg_mixmod.lst">output</a>.<p>

<li><i> <font color="#cc0000">Chapter 9, Soybean growth study.  Using
R nlme() and SAS macro nlimix and proc nlmixed to implement the
nonlinear mixed effects model in the course
notes.  </font></i>.  <a href="examples/soy_nlme.R">R program using
nlme()</a>, <a href="examples/soybean.nocov.pdf">Plot of random
effects vs covariates from model with no covariates</a>, and
<a href="examples/soybean.cov.pdf">Plot of random
effects vs covariates from model  with covariates</a>; 
 <a href="examples/soy_nlinmix.sas">SAS program
using the nlinmix macro</a>, <a
href="examples/soy_nlinmix.log">log file</a>, 
and <a
href="examples/soy_nlinmix.lst">output</a>;
<a href="examples/soy_nlmixed.sas">SAS program using proc
nlmixed</a>, <a href="examples/soy_nlmixed.log">log file</a>, 
and <a
href="examples/soy_nlmixed.lst">output</a>;
and <a
href="examples/soyR.dat">data set in "long" format</a>.  
<p>

<li><i> <font color="#cc0000">Chapter 9, Pharmacokinetics of
phenobarbital.  Using R nlme() 
to implement the nonlinear mixed effects models in the course
notes.  </font></i>.  <a href="examples/pheno_nlme.R">R program using
nlme()</a>, <a href="examples/pheno.nocov.pdf">Plots of random
effects vs covariates from model (i) with no covariates</a>, and
<a href="examples/pheno.cov.pdf">Plots of random
  effects vs covariates from model (ii) with  birthweight included as a
  covariate in the population model</a>;
  
     </ul>

<br class="clear_float" />
</div>
<br class="clear_float" />
<br/>


<div id="footer">
<hr color="#cc0000" width="100%">
Last Updated: October 2018
</div>
</body>
</html>
